<div class="container container-narrow">
  <div class="header-section">
    <h1>My Journal</h1>
    <p>Capture your journey, one day at a time.</p>
  </div>

  <!-- Add Entry Card -->
  <div class="glass-card compose-card">
    <div class="card-header">
      <h3><mat-icon>edit_note</mat-icon> {{ isEditing ? 'Edit Entry' : 'New Entry' }}</h3>
    </div>

    <form [formGroup]="entryForm" (ngSubmit)="submitEntry()">
      <div class="mood-selector">
        <label>How are you feeling?</label>
        <mat-radio-group formControlName="mood" class="mood-options">
          @for (mood of moods; track mood) {
          <mat-radio-button [value]="mood" [class.selected]="entryForm.get('mood')?.value === mood">
            <span class="mood-emoji">{{ mood }}</span>
          </mat-radio-button>
          }
        </mat-radio-group>
      </div>

      <mat-form-field appearance="outline" class="full-width journal-input">
        <textarea matInput formControlName="content" placeholder="What's on your mind today?" rows="4"></textarea>
      </mat-form-field>

      <div class="form-actions">
        <button mat-button type="button" (click)="cancelEdit()" *ngIf="isEditing" class="btn-cancel">
          Cancel
        </button>
        <button class="btn-primary" type="submit" [disabled]="!entryForm.valid">
          {{ isEditing ? 'Update Entry' : 'Save Entry' }}
        </button>
      </div>
    </form>
  </div>

  <!-- Timeline -->
  <div class="timeline-container">
    @if (!entries.length) {
    <div class="empty-state">
      <mat-icon>import_contacts</mat-icon>
      <h3>Your journal is empty</h3>
      <p>Start writing to track your progress.</p>
    </div>
    }

    <div class="timeline">
      @for (entry of entries; track entry.id) {
      <div class="timeline-item">
        <div class="timeline-marker"></div>
        <div class="timeline-content glass-card">
          <div class="entry-header">
            <div class="entry-date">{{ entry.date | date:'longDate' }}</div>
            <div class="entry-mood">{{ entry.mood }}</div>
          </div>

          <div class="entry-body">
            <p>{{ entry.content }}</p>
          </div>

          <div class="entry-actions">
            <span class="timestamp">{{ entry.date | date:'shortTime' }}</span>
            <div class="action-buttons">
              <button mat-icon-button (click)="editEntry(entry)" matTooltip="Edit">
                <mat-icon>edit</mat-icon>
              </button>
              <button mat-icon-button color="warn" (click)="deleteEntry(entry.id!)" matTooltip="Delete">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </div>
      </div>
      }
    </div>
  </div>
</div>